# Пакеты

<p class="uk-article-lead">Пакеты (Packages) это концепция Pagekit для расширения функциональности. Пакеты бывают двух различных типов: Расширения и Темы.</p>

* [Местоположение пакета](#package-location)
* [Содержимое пакета](#package-content)
* [Определение пакета](#package-definition)
* [Установка хуков](#installation-hooks)

<h2 id="package-location">Местоположение пакетов</h2>

Все пакеты находятся в директории */packages* и отсортированные в подкаталоги в соответствии с их поставщиком.

Каждый пакет относится к определенному поставщику, например *pagekit/* для всех официальных пакетов, включая расширение **Blog** и тему **One**.

Имя поставщика это уникальное представление разработчика или организации. В простейшем случае он просто соответствует имени пользователя на GitHub. Имя пакета также будет определять имя каталога, в котором он хранится.

<h2 id="package-content">Содержимое пакета</h2>

В пакете хранится как минимум два файла:

1. *composer.json* - содержит метаданные для вашего пакета и следовательно выступает в качестве определения пакета.
2. *index.php* - также называется определением модуля и фактически добавляет функциональность Pagekit.

Остальная часть содержимого пакета зависит от типа пакета. Чтобы изучить больше о фактическом содержимо пакета, ознакомтесь с [учебным руководством по созданию тем](../tutorials/theme.md) или [созданию расширений](../tutorials/extension.md).

## Определение пакета

Пакет определяется файлом *composer.json*. Этот файл включает в себя имя пакета, список зависимостей, которые должны устанавливатся с помощью [Composer](https://getcomposer.org) и другую информацию, которая отображается в маркетплейс Pagekit.

Для темы, этот файл может выглядеть таким образом:

```json
{
    "name": "pagekit/theme-hello",
    "type": "pagekit-theme",
    "version": "0.9.0",
    "title": "Hello",
    "description": "A blueprint to develop your own themes.",
    "license": "MIT",
    "authors": [
        {
            "name": "Pagekit",
            "email": "info@pagekit.com",
            "homepage": "http://pagekit.com"
        }
    ],
    "extra": {
        "image": "image.jpg"
    }
}
```

Для получения более подробной информации о этом файле смотрите [документацию по Composer](https://getcomposer.org/doc/01-basic-usage.md).

## Установка хуков

Пакет может быть либо включеным, либо выключеным или не установленным. При изменении состояния, возможно, потребуется изменить схему базы данных или запустить другой пользовательский код.

Pagekit предлагает хуки/крючки установки через кастомный файл скриптов. Этот файл нужно определить в вашем определении пакета, файла *composer.json*.

```json
"extra": {
    "scripts": "scripts.php"
}
```

Пользовательский файл скрипта должен вернуть массив PHP, содержащий колбеки.

```php
return [

    'install' => function ($app) {},
    'uninstall' => function ($app) {},
    'enable' => function ($app) {},
    'disable' => function ($app) {},
    'updates' => [

        '0.5.0' => function ($app) {},
        '0.9.0' => function ($app) {}

    ]
];
```

### Установка

Хук установки выполнятся после того как пакет был установлен.

### Удаление

Хук удаления выполняется перед тем как пакет был удалён.

Pagekit не изменит таблицы, которые вы создали, даже когда ваше расширение отлючено или удалено в панели управления. Вы должны будете сами заботиться о необходимых изменениях базы данных.

### Активация

Хук активации выполняется после того как пакет был активирован.

### Деактивация

Хук деактивации выполняется после того как пакет был отключён.

### Обновление

При включении пакета, Pagekit проверяет, доступны ли новые хуки обновления. Если да, то они выполняются последовательно.